(function(e){function t(t){for(var r,i,c=t[0],s=t[1],l=t[2],u=0,p=[];u<c.length;u++)i=c[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);f&&f(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var f=s;a.push(["6b90","chunk-vendors"]),n()})({0:function(e,t){},"01c7":function(e,t,n){"use strict";var r=n("2154"),o=n.n(r);o.a},1:function(e,t){},"1f89":function(e,t,n){"use strict";var r=n("f692"),o=n.n(r);o.a},2:function(e,t){},2154:function(e,t,n){},3:function(e,t){},4:function(e,t){},"4a9e":function(e,t){e.exports="data:image/png;base64,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"},5:function(e,t){},5295:function(e,t,n){},6:function(e,t){},"6b90":function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e._m(0),n("div",{staticClass:"demo"},[n("h3",[e._v("导出demo")]),n("export-demo")],1),n("div",{staticClass:"demo"},[n("h3",[e._v("导入demo")]),n("import-demo")],1),e._m(1)])},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header"},[r("img",{staticClass:"logo",attrs:{src:n("4a9e")}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"address"},[n("a",{attrs:{href:"https://github.com/pikaz-18/pikaz-excel-js/tree/master/src/example/components"}},[e._v("demo代码地址")])])}],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"export-demo"},[n("excel-export",{attrs:{bookType:e.bookType,filename:e.filename,sheet:e.sheet,"on-error":e.onError}},[n("div",{staticClass:"export-btn"},[e._v("点击导出")])])],1)},c=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"excel-export",on:{click:function(t){!e.manual&&e.pikaExportExcel()}}},[e._t("default")],2)},l=[],f=(n("99af"),n("cb29"),n("4de4"),n("4160"),n("c975"),n("d81d"),n("13d5"),n("c19f"),n("b64b"),n("d3b7"),n("4d63"),n("ac1f"),n("25f0"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("159b"),n("ddb0"),n("2909")),u=n("5530"),p=n("21a6"),h=n("2615"),d=n.n(h);function m(){if(!(this instanceof m))return new m;this.SheetNames=[],this.Sheets={}}var b={props:{bookType:{type:String,default:"xlsx"},filename:{type:String,default:"excel"},manual:{type:Boolean,default:!1},sheet:{type:Array,default:function(){return[]}},beforeStart:{type:Function,default:function(e,t,n){}},beforeExport:{type:Function,default:function(e,t,n){}},onError:{type:Function,default:function(e){}}},components:{},data:function(){return{default:{sheetName:"sheet",globalStyle:{border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},font:{name:"宋体",sz:12,color:{rgb:"000000"},bold:!1,italic:!1,underline:!1,shadow:!1},alignment:{horizontal:"center",vertical:"center",wrapText:!1},fill:{fgColor:{rgb:"ffffff"}}}},enum:{bookType:["xlsx","xls"]}}},created:function(){},mounted:function(){},methods:{datenum:function(e,t){t&&(e+=1462);var n=Date.parse(e);return(n-new Date(Date.UTC(1899,11,30)))/864e5},sheet_from_array_of_arrays:function(e,t){for(var n={},r={s:{c:1e9,r:1e9},e:{c:0,r:0}},o=0;o!=e.length;++o)for(var a=0;a!=e[o].length;++a){r.s.r>o&&(r.s.r=o),r.s.c>a&&(r.s.c=a),r.e.r<o&&(r.e.r=o),r.e.c<a&&(r.e.c=a);var i={v:e[o][a]};if(null!=i.v){var c=d.a.utils.encode_cell({c:a,r:o});"number"===typeof i.v?i.t="n":"boolean"===typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=d.a.SSF._table[14],i.v=this.datenum(i.v)):i.t="s",n[c]=i}}return r.s.c<1e9&&(n["!ref"]=d.a.utils.encode_range(r)),n},s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t},pikaExportExcel:function(){var e=this,t=this.beforeStart(this.bookType,this.filename,this.sheet);if(!1!==t)if(!this.sheet||this.sheet.length<=0)this.onError("Table data cannot be empty");else{var n=new m;this.sheet.forEach((function(t,r){var o=t.title,a=t.tHeader,i=t.multiHeader,c=t.table,s=t.merges,l=t.keys,p=t.colWidth,h=t.sheetName,m=t.globalStyle,b=t.cellStyle;h=h||e.default.sheetName;var A=e.default.globalStyle;if(m?Object.keys(A).forEach((function(e){m[e]=Object(u["a"])(Object(u["a"])({},A[e]),m[e])})):m=A,o||0===o||""===o){var v=a&&a.length||0,x=i&&Math.max.apply(Math,Object(f["a"])(i.map((function(e){return e.length}))))||0,y=Math.max(v,x,l.length);o=[o].concat(Array(y-1).fill(""));var g=String.fromCharCode(64+y)+"1",S="A1:".concat(g);s?-1===s.indexOf(S)&&s.push(S):s=[S]}var k=c.map((function(e){return l.map((function(t){return e[t]}))}));if(i)for(var j=i.length-1;j>=0;j--)k.unshift(i[j]);a&&k.unshift(a),o&&k.unshift(o);var E=e.sheet_from_array_of_arrays(k);if(s&&s.length>0&&(E["!merges"]||(E["!merges"]=[]),s.forEach((function(e){E["!merges"].push(d.a.utils.decode_range(e))}))),p)E["!cols"]=p.map((function(e){return{wch:e}}));else{for(var w=m.font.sz&&m.font.sz/12||1,O=10*w+2,N=2*w,F=w,T=k.map((function(e){return e.map((function(e){if(e){var t=e.split(""),n=new RegExp("[一-龥]+"),r=t.map((function(e){return n.test(e)?N:F}));return r=r.reduce((function(e,t){return e+t}),0),{wch:r+2}}return{wch:O}}))})),C=T[0],P=1;P<T.length;P++)for(var _=0;_<T[P].length;_++)C[_]["wch"]<T[P][_]["wch"]&&(C[_]["wch"]=T[P][_]["wch"]);E["!cols"]=C}n.SheetNames.push(h),n.Sheets[h]=E;var G=n.Sheets[n.SheetNames[r]];(function(){Object.keys(G).forEach((function(e){"!ref"==e||"!merges"==e||"!cols"==e||(G[e.toString()].s=m)}))})(),function(){!b||b.length<=0||b.forEach((function(e){var t=e.border,n=e.font,r=e.alignment,o=e.fill;G[e.cell].s={border:t||m.border,font:n||m.font,alignment:r||m.alignment,fill:o||m.fill}}))}()}));var r=this.enum.bookType.filter((function(t){return t===e.bookType}))[0]||this.enum.bookType[0];this.writeExcel(n,r,this.filename)}},writeExcel:function(e,t,n){var r=d.a.write(e,{bookType:t,bookSST:!1,type:"binary"}),o=new Blob([this.s2ab(r)],{type:"application/octet-stream"}),a=this.beforeExport(o,t,n);!1!==a&&Object(p["saveAs"])(o,"".concat(n,".").concat(t))}},computed:{},watch:{}},A=b,v=n("2877"),x=Object(v["a"])(A,s,l,!1,null,"fd25ea54",null),y=x.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"excel-import",on:{click:e.importFileClick}},[n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"importFile",accept:".xls,.xlsx"},on:{change:function(t){return e.importFile(this)}}}),e._t("default")],2)},S=[],k=(n("c740"),n("fb6a"),n("45fc"),n("b0c0"),n("b1f8")),j=n("1146"),E=n.n(j),w={props:{sheetNames:Array,beforeImport:{type:Function,default:function(e){}},onProgress:{type:Function,default:function(e,t){}},onChange:{type:Function,default:function(e){}},onSuccess:{type:Function,default:function(e,t){}},onError:{type:Function,default:function(e,t){}}},components:{},data:function(){return{imFile:"",enum:{bookType:["xlsx","xls"]}}},created:function(){},mounted:function(){this.imFile=document.getElementById("importFile")},methods:{importFileClick:function(){this.imFile.click()},importFile:function(){var e=this,t=this.imFile;if(t.files){var n=t.files[0],r=this.beforeImport(n);if(this.onChange(n),!1!==r){var o=n.name.substr(n.name.length-4,n.name.length-1),a=this.enum.bookType.some((function(e){return-1!==o.indexOf(e)}));if(a){var i=new FileReader,c=this;i.onprogress=function(t){e.onProgress(t,n)},i.onload=function(t){var r=t.target.result;c.rABS?c.wb=E.a.read(btoa(e.fixdata(r)),{type:"base64"}):c.wb=E.a.read(r,{type:"binary"});var o=[];if(c.sheetNames)c.sheetNames.forEach((function(e){var t=c.wb.SheetNames.findIndex((function(t){return t===e}));if(-1!==t){var n=E.a.utils.sheet_to_json(c.wb.Sheets[c.wb.SheetNames[t]]);o.push({sheetName:e,data:n})}}));else for(var a=0;a<c.wb.SheetNames.length;a++){var i=E.a.utils.sheet_to_json(c.wb.Sheets[c.wb.SheetNames[a]]);o.push({sheetName:c.wb.SheetNames[a],data:i})}c.dealFile(o,n)},this.rABS?i.readAsArrayBuffer(n):i.readAsBinaryString(n)}else this.onError('The file type must be "xlsx" or "xls"',n)}}else this.onError("No imported file")},dealFile:function(e,t){return this.imFile.value="",e.length<=0?(this.onChange(t),void this.onError("The import failed",t)):(this.onChange(t),void this.onSuccess(e,t))},fixdata:function(e){for(var t="",n=0,r=10240;n<e.byteLength/r;Object(k["a"])("l"),++n)t+=(Object(k["a"])("o"),String.fromCharCode.apply(null,new Uint8Array(e.slice(n*r,n*r+r))));return t+=(Object(k["a"])("o"),String.fromCharCode.apply(null,new Uint8Array(e.slice(n*r)))),t}},computed:{},watch:{}},O=w,N=Object(v["a"])(O,g,S,!1,null,"78a509c6",null),F=N.exports,T={props:{},components:{ExcelExport:y},data:function(){return{bookType:"xlsx",filename:"export-demo",sheet:[{title:"插件信息",tHeader:["作者","语言","插件名称","插件用途"],table:[{author:"pikaz",language:"javascript",name:"pikaz-excel-js",application:"excel的导入导出"}],keys:["author","language","name","application"],sheetName:"插件信息",cellStyle:[{cell:"A1",font:{sz:14,color:{rgb:"ffffff"},bold:!0},fill:{fgColor:{rgb:"ff7e00"}}}]},{title:"插件信息2",multiHeader:[["基础信息","","","详细信息"],["作者","语言","插件名称","插件用途"]],table:[{author:"pikaz",language:"javascript",name:"pikaz-excel-js",application:"excel的导入导出"}],keys:["author","language","name","application"],merges:["A2:C2"],colWidth:[16,16,16,20],sheetName:"插件信息2",globalStyle:{font:{color:{rgb:"ff7e00"}}},cellStyle:[{cell:"A1",font:{name:"宋体",sz:14,color:{rgb:"ffffff"},bold:!0},fill:{fgColor:{rgb:"ff7e00"}}}]}]}},created:function(){},mounted:function(){},methods:{onError:function(e){console.log(e)},exportTable:function(){this.$refs.excelExport.pikaExportExcel()}},computed:{},watch:{}},C=T,P=(n("1f89"),Object(v["a"])(C,i,c,!1,null,"f123b1d0",null)),_=P.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"import-demo"},[n("excel-import",{attrs:{"on-success":e.onSuccess}},[n("div",{staticClass:"import-btn"},[e._v("点击导入")])]),e.json?n("div",{staticClass:"code"},[e._v(" "+e._s(e.json)+" ")]):e._e()],1)},z=[],B={props:{},components:{ExcelImport:F},data:function(){return{json:""}},created:function(){},mounted:function(){},methods:{onSuccess:function(e,t){this.json=JSON.stringify(e)}},computed:{},watch:{}},q=B,V=(n("01c7"),Object(v["a"])(q,G,z,!1,null,"4c04800d",null)),I=V.exports,J={name:"App",components:{ExportDemo:_,ImportDemo:I}},L=J,M=(n("c786"),Object(v["a"])(L,o,a,!1,null,null,null)),Z=M.exports;n("7be5");r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(Z)}}).$mount("#app")},"7be5":function(e,t,n){},c786:function(e,t,n){"use strict";var r=n("5295"),o=n.n(r);o.a},f692:function(e,t,n){}});